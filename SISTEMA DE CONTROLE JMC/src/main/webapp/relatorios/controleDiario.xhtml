<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">
<ui:composition template="../templates/administrador.xhtml">
	<ui:define name="title">
		<title>Controle Diario</title>
	</ui:define>
  <ui:define name="content">
    <h:form enctype="multipart/form-data" prependId="false" id="growlForm">
      <p:growl id="growl" showDetail="false" />
    </h:form>
    <h:form>
    	<p:fieldset legend="Filtro">
    		<h:panelGrid columns="2">
    			<p:outputLabel value="De" for="dataInicialFilter"/>
    			<p:calendar id="dataInicialFilter" required="true"/>
    			
    			<p:outputLabel value="Ate" for="dataFinalFilter"/>
    			<p:calendar id="dataFinalFilter" required="true"/>
    			
    			<p:outputLabel value="Turno" for="turnoFilter" />
		    	<p:selectOneMenu id="turnoFilter">
					<f:selectItem itemLabel="Selecione um turno" itemValue="" />
					<f:selectItems value="#{controleValoresPendentesBean.turno}" var="setor" itemLabel="#{setor.label}" />
				</p:selectOneMenu>
    		</h:panelGrid>
    		<p:commandButton value="Pesquisar"/>
    	</p:fieldset>
    </h:form>
    <h:form prependId="false" id="dataForm">
		<p:dataTable id="list" var="list" value="#{controleDiarioBean.fechamentos}" scrollable="true" paginator="true" rows="10">
			<f:facet name="header">Controle Diario</f:facet>
			<p:column headerText="Data" sortBy="#{list.data}" width="70">
				<h:outputText value="#{list.data}">
					<f:convertDateTime pattern="dd/MM/yyyy"/>
				</h:outputText>
			</p:column>
			<p:column headerText="Truno" width="70">
				<h:outputText value="#{list.turno.label}"/>
			</p:column>
			<p:column headerText="Dinheiro" width="70">
				<h:outputText value="#{list.dinheiro}">
					<f:convertNumber minFractionDigits="2"/>
				</h:outputText>
			</p:column>
			<p:column headerText="Trocado" width="70">
				<h:outputText value="#{list.trocado}">
					<f:convertNumber minFractionDigits="2"/>
				</h:outputText>
			</p:column>
			<p:column headerText="Moeda" width="70">
				<h:outputText value="#{list.moeda}">
					<f:convertNumber minFractionDigits="2"/>
				</h:outputText>
			</p:column>
			<p:column headerText="Web" width="70">
				<h:outputText value="#{list.web}">
					<f:convertNumber minFractionDigits="2"/>
				</h:outputText>
			</p:column>
			<p:column headerText="cartao" width="70">
				<h:outputText value="#{list.cartao}">
					<f:convertNumber minFractionDigits="2"/>
				</h:outputText>
			</p:column>
			<p:column headerText="Cheque" width="70">
				<h:outputText value="#{list.cheque}">
					<f:convertNumber minFractionDigits="2"/>
				</h:outputText>
			</p:column>
			<p:column headerText="Sangria" width="70">
				<h:outputText value="#{list.sangriaCaixa}">
					<f:convertNumber minFractionDigits="2"/>
				</h:outputText>
			</p:column>
			<p:column headerText="Sangria (Gastos)" width="70">
				<p:commandLink value="#{list.sangriaGastos}" action="#{controleDiarioBean.carregarDespesas()}" onclick="PF('despesas').show()" update=":dataFormDespesas:list">
					<f:setPropertyActionListener value="#{list}" target="#{controleDiarioBean.fechamento}" />
				</p:commandLink>
			</p:column>
			<p:column headerText="Contas a Cobrar" width="70">
				<p:commandLink value="#{list.cobrar}" action="#{controleDiarioBean.carregarControleValoresCobrar()}" onclick="PF('valores').show()" update=":dataFormValores:list">
					<f:setPropertyActionListener value="#{list}" target="#{controleDiarioBean.fechamento}" />
				</p:commandLink>
			</p:column>
			<p:column headerText="Contas a Receber" width="70">
				<p:commandLink value="#{list.receber}" action="#{controleDiarioBean.carregarControleValoresReceber()}" onclick="PF('valores').show()" update=":dataFormValores:list">
					<f:setPropertyActionListener value="#{list}" target="#{controleDiarioBean.fechamento}" />
				</p:commandLink>
			</p:column>
			<p:column headerText="Total Fechemento" width="70">
				<h:outputText value="#{list.totalFechamento}">
					<f:convertNumber minFractionDigits="2"/>
				</h:outputText>
			</p:column>
			<p:column headerText="DiferenÃ§a" width="70">
				<h:outputText value="#{list.diferenca}">
					<f:convertNumber minFractionDigits="2"/>
				</h:outputText>
			</p:column>
			<p:column headerText="Justificativa" width="150">
				<h:outputText value="#{list.justificativa}"/>
			</p:column>
		</p:dataTable>
	</h:form>
		
		<!-- Despesas  -->	
		<p:dialog id="despesas" header="Depesas" modal="true" widgetVar="despesas" showEffect="fade" hideEffect="explode" width="900">
			<h:form id="dataFormDespesas">
		        <p:dataTable id="list" value="#{controleDiarioBean.sangrias}" var="sangria" paginator="true">
		          	<p:column headerText="Item" sortBy="#{sangria.item.descrisao}">
		          		<h:outputText value="#{sangria.item.descrisao}"/>
		          	</p:column>
		        	<p:column headerText="Data" sortBy="#{sangria.periodo}">
		          		<h:outputText value="#{sangria.periodo}">
		          			<f:convertDateTime pattern="dd/MM/yyyy"/>
		          		</h:outputText>
		          	</p:column>
		          	<p:column headerText="Valor" sortBy="#{sangria.valor}">
		          		<h:outputText value="#{sangria.valor}">
		          			<f:convertNumber minFractionDigits="2"/>
		          		</h:outputText>
		          	</p:column>
		 		</p:dataTable>
		 	</h:form>
		</p:dialog>
		
		<!-- Controle de valores  -->	
		<p:dialog id="valores" header="Depesas" modal="true" widgetVar="valores" showEffect="fade" hideEffect="explode" width="900">
			<h:form id="dataFormValores">
		        <p:dataTable id="list" value="#{controleDiarioBean.valoresPendentes}" var="valores" paginator="true">
		          	<p:column headerText="Item" sortBy="#{valores.numeroPedido}">
		          		<h:outputText value="#{valores.numeroPedido}"/>
		          	</p:column>
		        	<p:column headerText="Data" sortBy="#{valores.data}">
		          		<h:outputText value="#{valores.data}">
		          			<f:convertDateTime pattern="dd/MM/yyyy"/>
		          		</h:outputText>
		          	</p:column>
		          	<p:column headerText="Valor" sortBy="#{valores.valor}">
		          		<h:outputText value="#{valores.valor}">
		          			<f:convertNumber minFractionDigits="2"/>
		          		</h:outputText>
		          	</p:column>
		 		</p:dataTable>
		 	</h:form>
		</p:dialog>			
  </ui:define>
</ui:composition>
</html>